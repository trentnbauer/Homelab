name: trentbauer.com/pelicanpanel-auth-parser
description: "Parse Pelican Panel auth logs from MySQL"
# Changed evt.Labels.type to evt.Parsed.type
filter: "evt.Meta.datasource == 'mysql' && evt.Parsed.type == 'pelican-auth'"
onsuccess: next_stage
nodes:
  - grok:
      pattern: "%{IP:source_ip}"
      apply_on: evt.Parsed.ip
  - grok:
      pattern: "%{TIMESTAMP_ISO8601:timestamp}"
      apply_on: evt.Parsed.timestamp
statics:
  - meta: log_type
    value: pelican_failed_auth
  - target: evt.StrTime
    expression: evt.Parsed.timestamp
