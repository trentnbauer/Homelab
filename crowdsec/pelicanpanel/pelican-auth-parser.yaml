name: trentbauer.com/pelicanpanel-auth-parser
description: "Parse Pelican Panel login failures from MariaDB"
filter: "evt.Meta.type == 'pelican-auth'"
onsuccess: next_stage
nodes:
  - grok:
      # Use single quotes to ensure \s is treated as a regex space, not a YAML escape
      pattern: '^%{IP:source_ip}\s+%{DATA:user_email}\s+%{TIMESTAMP_ISO8601:timestamp}'
      apply_on: message
statics:
  - target: evt.StrTime
    src: timestamp
  - target: evt.Meta.source_ip
    src: source_ip
  - target: evt.Meta.user
    src: user_email
